# PART1. 데이터 모델링의 이해

## CHAPTER1. 데이터 모델링의 이해

### 1. 데이터 모델

- 모델 : 현실 세계에서 일어날 수 있는 다양한 현상에 대해 일정한 표기법에 의해 표현해 놓은 모형(도식화)
- (ex) 음식을 주문하는 행위 : 고객-주문한다-상품

#### (1) 모델링

현실 세계를 반영한 모델을 단순화하여 표현한 것

- 모델링 조건

  - 현실 세계를 반영해야함
  - 단순화
  - 관리하고자 하는 데이터를 모델로 설계

- 모델링 특징

  - 추상화(Abstraction) : 현실 세계를 일정한 형식으로 표현하는 것, 아이디어나 개념을 간략하게 표현
  - 단순화(Simplification) : 복잡한 현실 세계를 정해진 표기법으로 단순하고 쉽게 표현
  - 명확화(Clarity) : 불분명함을 제거하고 명확하게 해석할 수 있도록 기술

- 모델링 기능
  - 시스템이 변화하고자 하는 모습을 가시화
  - 시스템 구축 과정에서 결정한 것을 문서화
  - 시스템을 구축하는 구조화된 틀 제공
  - 시스템 구조와 행동을 명세화
- 모델링 세 가지 관점

  - 데이터 관점(What,Data) : 어떤 데이터들이 업무와 얽혀있는지, 데이터간에는 어떤 관계가 있는지
  - 프로세스 관점(How,Process) : 업무가 실제로 처리하고 있는 일은 무엇인지, 앞으로 처리해야 하는 일은 무엇인지
  - 데이터와 프로세스의 상관 관점(Data vs. Process,Interation) : 프로세스와 데이터의 관계 위주, 프로세스의 흐름에 따라 데이터가 어떤 영향을 받는지

- 데이터 품질 유지를 위해 지양해야할 점 (모델링 시 유의)

  - 중복 : 같은 데이터가 여러 엔터티에 중복으로 저장되는 현상 지양
  - 비유연성 : 데이터 모델과 프로세스 분리
  - 비일관성 : 데이터 간의 연관 관계에 대해 명확하게 정의

- 모델링 3단계

  1. 개념적 데이터 모델링 : 전사적 데이터 모델링, 추상화 레벨이 가장 높음, 업무 중심적이고 포괄적인 수준의 모델링
  2. 논리적 데이터 모델링 : 재사용성이 가장 높은 모델링, 데이터베이스 모델에 대한 모든 것을 표현(Key,속성,관계 등)
  3. 물리적 데이터 모델링 : 실제 데이터베이스로 구현할 수 있도록 성능 등 물리적 성격을 고려하여 모델을 표현

- ANSI-SPARC아키텍처

  - 1975년 제안된 DBMS의 추상적인 설계 표준 (스키마 3단계)
  - DB에 대한 사용자들의 관점과 DB가 실제로 표현되는 물리적인 방식을 분리하기 위함
  - 사용자 입장에서는 필요한 데이터만 보고, DBA의 입장에서는 애플리케이션에 영향을 주지 않고 DB구조를 변경할 수 있어야 독립성 보장
  - [ USER - 외부 단계 - 개념 단계 - 내부 단계 - DB ]

    - 외부 스키마 : 사용자 관점, Multiple User's View, 각 사용자(응용프로그래머)가 보는 DB의 스키마
    - 개념 스키마 : 통합된 관점, Community View of DB, 모든 사용자가 보는 스키마를 통합, DB에 저장되는 데이터들을 표현하고 데이터들 간의 관계를 나타냄
    - 내부 스키마 : 물리적 관점, Physical Representation, 실질적인 데이터의 저장구조/컬럼 정의/인덱스 등을 포함한 물리적 저장구조

  - 독립성 보장
    - 논리적 독립성 : 개념 스키마가 변경되어도 외부 스키마는 영향 받지 않음
    - 물리적 독립성 : 내부 스키마가 변경되어도 외부/개념 스키마는 영향 받지 않음

- ERD(Entity Relationship Diagram)

  - 시스템에 어떤 엔터티들이 존재하며 어떤 관계가 있는지 나타내는 다이어그램
  - 작성 순서
    1. 엔터티를 도출하고 그림
    2. 엔터티 배치
    3. 엔터티간의 관계 설정
    4. 관계명을 기입
    5. 관계의 참여도를 기입
    6. 관계의 필수/선택 여부 기입
  - 표기 방식
    - Peter Chen : 주로 대학교에서 사용
    - IDEF1X : ERWin(ERD 모델링툴)에서 사용되는 모델
    - IE/Crow's Foot : 까마귀발 표기법, ERWin/ERStudio에서 사용되는 모델
    - Min-Max/ISO : 각 엔터티의 참여도 상세
    - UML : 소프트웨어 공학에서 사용
    - Case\*Method/Barker : Oracle에서 사용, Crow's Foot과 비슷

---

### 2. 엔터티(Entity)

#### (1) 정의

- 식별 가능한 객체
- 명확한 조건을 기준으로 함
- 관련 학자
  - Peter Chen : 식별할 수 있는 사물 (가장 많이 출제)
  - C.J Date : DB내에서 식별 가능한 객체, 관계형 모델의 이론가
  - James Martin : 정보를 저장할 수 있는 어떤 것
  - Thomas Bruce : 정보를 저장할 수 있는 사람, 장소, 물건, 사건 그리고 개념 등

#### (2) 구조

- 엔터티 : Table
- 인스턴스 : Row
- 속성 : Column
  - 각 엔터티는 자신을 더 상세하게 나타내기 위해 속성을 가짐

#### (3) 특징

- 업무에 쓰이는 정보여야 도출하는 의미가 있음
- 약어x, 대문자, 단수명사, 띄어쓰기x, 중복의미x
- 유니크함을 보장할 수 있는 식별자가 있어야함(각 인스턴스를 구분)
- 2개 이상의 인스턴스 o
- 반드시 속성이 있어야함
- 다른 엔터티와 1개 이상의 관계 o

#### (4) 분류

- 유형 / 무형

  - 유형 엔터티 : 물리적 형태 존재 (상품, 회원 등)
  - 개념 엔터티 : 형태 x (부서, 학과 등)
  - 사건 엔터티 : 행위를 함으로써 발생 (주문, 이벤트 응모 등)

- 발생 시점
  - 기본 엔터티 : 업무에 원래 존재, 독립적으로 생성, 자식 엔터티 o (상품, 회원, 부서 등)
  - 중심 엔터티 : 기본 엔터티에서 파생, 행위 엔터티 생성, 업무의 중심 역할 (주문, 매출, 계약 등)
  - 행위 엔터티 : 2개 이상의 엔터티로부터 파생, 자주 변경 (주문 내역, 응모 이력 등)

---

### 3. 속성(Attribute)

#### (1) 정의

- 엔터티의 특징을 나타내는 최소의 데이터 단위
- 의미상 더 이상 쪼개지지 않는 레벨
- 프로세스에 필요한 항목

#### (2) 속성값

- 하나의 속성은 한개의 속성값만 가질 수 있다
- 여러개의 속성값을 가질 경우 별도의 엔터티로 분리

#### (3) 분류

- 특성에 따른 분류
  - 기본 속성 : 바로 정의가 가능
  - 설계 속성 : 존재하지는 않지만 설계하다가 도출 (ex)학번
  - 파생 속성 : 다른 속성의 값을 계산하거나 특정한 규칙으로 변형하여 생성(보통 빠른 성능을 위해 사용), 데이터 정합성 주의 (ex) 재고
- 구성방식에 따른 분류
  - PK(Primary Key)속성 : 엔터티의 인스턴스들을 식별할 수 있는 속성
  - FK(Foreign Key)속성 : 다른 엔터티의 속성에서 가져온 속성, 다른 엔터티와의 관계의 매개체, NULL 가능
  - 일반 속성 : PK, FK 외

* 추가 용어 정리
  - 후보키 : 유일성과 최소성을 만족하는 속성 집합
  - PK : 후보키 중 하나
  - 대체키 : 후보키 중 PK가 아닌 나머지
  - 슈퍼키 : 유일성만 만족하는 집합

#### (4) 도메인

- 속성이 가질 수 있는 속성값의 범위

##### (5) 용어사전, 시스템 카탈로그

- 용어사전 : 속성명 정의 등 혼란을 예방하기 위한 업무사전
- 시스템 카탈로그 : 사용자 테이블과는 별개로 시스템 자체에 관련이 있는 데이터(메타데이터)를 담고 있는 DB, SQL로 조회(SELECT) 만 가능

---

### 4. 관계(Relationship)

#### (1) 정의

- 엔터티와 엔터티와의 관계를 의미
- 어떠한 연관성이 있는지 타입을 분류 (존재관계 / 행위 관계)
  - 존재 관계 : 존재 자체로 연관 (직원 - 부서)
  - 행위 관계 : 행위로 연관성 생성 (회원 - 주문)

#### (2) 표기법

- 관계명(Membership) : 각 엔터티의 관점에서 관계명을 하나씩 가짐 (총 2개), 현재형으로 표시
- 관계차수(Cardinality) : 관계에 참여하는 수 (1:1 , 1:M, M:N)
- 관계선택사양(Optionality) : 필수(참여자가 반드시 존재) / 선택(참여자가 없을 수도 있음)

---

### 5. 식별자(Identifiers)

- 속성 중에 각각의 인스턴스를 구분 가능하게 만들어주는 속성

#### (1) 주식별자

- PK , 기본키에 해당하는 속성
- 하나 또는 여러개가 될 수 있음
- 특징
  - 유일성
  - 최소성 : 유일성을 보장하는 최소 개수
  - 불변성
  - 존재성 : NULL불가능

#### (2) 식별자 분류

- 대표성 여부 : 주식별자 / 보조식별자
- 스스로 생성 : 내부식별자 / 외부식별자(다른 엔터티에서 온 식별자)
- 단일 속성 : 단일식별자 / 복합식별자
- 대체 여부 : 본질식별자(원조식별자,가공X) / 인조식별자(대리식별자,두개이상의 속성을 하나로 묶어서 사용)

#### (3) 식별자 관계 VS 비식별자 관계

- 식별자 관계
  - 부모엔터티의 식별자가 자식 엔터티의 주식별자가 되는 관계
  - 부모 엔터티가 있어야 생성 가능 (주식별자는 반드시 존재)
  - 단일식별자, 복합 식별자인지에 따라 1:1 또는 1:M(부모:자식)
- 비식별자 관계
  - 부모엔터티의 식별자가 자식 엔터티의 일반 속성이 되는 관계
  - 부모 엔터티가 없는 자식 엔터티 O
  - 자식 엔터티가 존재하는 상태에서 부모 엔터티 삭제 X

---

---

## CHAPTER2. 데이터 모델과 SQL

### 1. 정규화

- 데이터 정합성 (데이터의 정확성과 일관성을 유지하고 보장)을 위해 엔터티를 작은 단위로 분리하는 과정
- 데이터에 대한 중복성을 제거
- 정규화를 할 수 록 엔터티는 증가
- 데이터 입력,수정,삭제 성능 향상
- 데이터 조회 성능은 조건에 따라 다름 ( 지나친 정규화는 성능 저하 발생 (EX) 지나친 JOIN 필요)
- 순차적으로 1,2,3차 정규형 진행

#### (1) 제1정규형(1NF)

- 모든 속성은 반드시 하나의 값만 가져야 한다 (엔터티 분리)
- 유사한 속성이 반복되는 경우 엔터티로 분리
  - 정규화를 통해 분리하면 인덱스를 단일 속성에만 생성할 수 있어 성능과 관리에 유리
    (EX) 속성명이 인스타그램, 페이스북 등 인 경우

#### (2) 제2정규형(2NF)

- 엔터티의 모든 일반속성은 반드시 모든 주식별자에 종속되어야한다
- 주식별자가 복합식별자일 경우 일부만 종속되면 안됨
  (EX) [주문번호, 음료코드] - 음료명
  1. 음료명은 음료코드만 종속됨
  2. 주문되지 않은 음료는 입력할 수 없음 (입력 이상 현상)
  3. 음료명이 변경될 경우 해당 음료에 대한 주문 데이터가 모두 변경되어야 함 (수정 이상 현상)
- 부분 종속이 없도록 엔터티를 분리

#### (3) 제3정규형(3NF)

- 주식별자가 아닌 모든 속성 간에는 서로 종속될 수 없다 (엔터티 분리)
- BCNF(보이스-코드 정규형) : 3NF의 강화버전, 주식별자를 포함한 모든 결정자는 반드시 후보키어야한다

#### (4) 4NF, 5NF, 도메인 키 정규형(DKNF)

- 4NF : 다치 종속 제거
- 5NF : 조인 종속을 분해하여 모든 관계가 유의미하도록 분해
- DKNF : 모든 제약조건이 도메인과 키에 의해서만 표현될 수 있는 정규형
